# AI Project Guide for Edukey Payload

This document is designed to help AI assistants understand the structure, architecture, and key components of the Edukey Payload project.
**AI Contributor Instructions**

- Review the project rules in `.cursor/rules/` for coding standards and overview.
- After significant changes, append a short summary to `docs/AI-CHANGES-LOG.md`.

## Project Overview

Edukey Payload is a website built with PayloadCMS v3, Next.js 15, React 19, and TypeScript. It serves as a platform for educational content, courses, and services.

## Key Technologies

- **PayloadCMS v3**: Headless CMS for content management
- **Next.js 15**: React framework with App Router
- **React 19**: UI library
- **TypeScript**: Programming language
- **TailwindCSS v4**: Utility-first CSS framework
- **Shadcn UI**: Component library
- **MongoDB**: Database
- **Docker**: Containerization
- **Coolify**: Deployment platform
- **GitHub Actions**: CI/CD

## Architecture

The project follows a modern web architecture with:

1. **Frontend**: Next.js App Router with React Server Components
2. **CMS**: PayloadCMS for content management
3. **Database**: MongoDB for data storage
4. **Deployment**: Docker containers managed by Coolify
5. **CI/CD**: GitHub Actions for build validation

## Project Structure

- `/src/app`: Next.js App Router pages
- `/src/app/(payload)`: PayloadCMS files, /admin panel and /api - DO NOT CHANGE THEM!!! (automatically generated by PayloadCMS)
- `/src/app/(frontend)`: Landing Page (our custom routes with i18n /pl/ and /en/)
- `/src/components`: Reusable React components
- `/src/blocks`: PayloadCMS block components (drag-n-drop in Admin UI)
- `/src/collections`: PayloadCMS collection definitions (Database structure, access rules, admin panel settings, etc.)
- `/src/globals`: PayloadCMS global definitions (Header, Footer, Settings)
- `/src/fields`: PayloadCMS field definitions (reusable in Collections and Blocks)
- `/src/i18n`: Internationalization configuration
- `/messages`: i18n translation files for our Landing Page
- `/src/utils`: Utility functions
- `/src/services`: Helpers for external services, like OpenAI SDK or pdfFreeConvert
- `/src/providers`: React context providers
- `/src/hooks`: PayloadCMS hooks reusable in many Collections/Blocks/Fields
- `/src/endpoints`: PayloadCMS generic endpoints to add as /api routes (managed by PayloadCMS)
- `/src/payload.config.ts`: PayloadCMS main config
- `/src/payload-plugins.ts`: PayloadCMS plugins config

## Key Features

- **Internationalization**: Supports multiple languages using next-intl
- **Dark Mode**: Supports light and dark themes
- **SEO Optimization**: Implements proper SEO metadata
- **Layout Builder**: Flexible content creation with blocks
- **Draft Preview**: Preview content before publishing
- **Authentication**: User management and authentication
- **Media Management**: Image optimization and management

## Development Workflow

1. **Local Development**: Run with `pnpm dev`, install with `pnpm add`
2. **Build**: Build with `pnpm build`
3. **Deployment**: Automatic deployment via Coolify when pushing to main branches
4. **CI/CD**: GitHub Actions for build validation on PRs, GitHub App to trigger Deploy

## Current Priorities

See the `docs/TODO.md` file for current priorities and tasks.

## Common Patterns

### PayloadCMS Collections

Collections are defined in `/src/collections` and follow this pattern:

```typescript
import { CollectionConfig } from 'payload/types';

export const MyCollection: CollectionConfig = {
  slug: 'my-collection',
  labels: {
    singular: { en: 'Collection', pl: 'Kolekcja' },
    plural: { en: 'Collections', pl: 'Kolekcje' }
  },
  admin: {
    useAsTitle: 'title',
    defaultColumns: ['title', 'intro'] // visible in Admin UI on lists
  },
  defaultPopulate: {
    // Default fields to populate in direct and joint queries
  },
  access: {
    // Access control
  },
  versions: {
    // Drafts and autosave configs (if needed for this collection)
  },
  fields: [
    // Fields
  ],
};
```

### React Components

Components are defined in `/src/components` and follow this pattern:

```typescript
import React from 'react';

interface MyComponentProps {
  // Props
}

export const MyComponent: React.FC<MyComponentProps> = ({ /* props */ }) => {
  // Component logic

  return (
    // JSX
  );
};
```

### Next.js Pages

Pages are defined in `/src/app` and follow this pattern:

```typescript
import { Metadata } from 'next';

export default async function Page() {
  // Page logic

  return (
    // JSX, in separate PageView Server Component for longer pages
  );
}

export async function generateMetadata({ params: paramsPromise }: Props): Promise<Metadata> {
  const { slug = 'home', locale } = await paramsPromise;
  const page = await queryPageBySlug({
    slug,
    locale,
  });

  return generateMeta({ doc: page, locale });
}

const queryPageBySlug = cache(async ({ slug, locale }: Params) => {
  const { isEnabled: draft } = await draftMode();

  const payload = await getPayload({ config: configPromise });

  const result = await payload.find({
    collection: 'pages',
    draft,
    limit: 1,
    pagination: false, // disable where we don't need `totalDocs`.
    overrideAccess: draft,
    locale,
    where: {
      slug: {
        equals: slug,
      },
    },
    select: {
      title: true,
      // fetch only data we need
    }
  });

  return result.docs?.[0] || null;
});
```

## Common Issues and Solutions

- **Import Errors**: We need to use PayloadCMS `pnpm gen:imports` script
- **Type errors**: We need to use PayloadCMS `pnpm gen:types` script
- **Carousel Issues**: Problems with the carousel arrows that need more padding

## Additional Resources

- PayloadCMS Documentation: https://payloadcms.com/docs
- Next.js Documentation: https://nextjs.org/docs
- TailwindCSS Documentation: https://tailwindcss.com/docs
- Coolify Docs: https://coolify.io/docs/get-started/introduction
- Next-Intl i18n Docs: https://next-intl.dev/docs/getting-started

## Context7 MCP Tools

To get newest documentation for tools we use in this project, you may use below Context7 MCP libraries:

- /vercel/next.js
- /tailwindlabs/tailwindcss.com
- /shadcn-ui/ui
- /reactjs/react.dev
- /payloadcms/payload
- /openai/openai-node
- /websites/platform_openai
